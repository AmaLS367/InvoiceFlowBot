<img src="https://capsule-render.vercel.app/api?type=waving&color=gradient&customColorList=6,11,20&height=120&section=header&text=–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞&fontSize=40&animation=fadeIn"/>

<div align="center">

<p align="center">
  <img src="https://readme-typing-svg.demolab.com?font=Fira+Code&size=18&duration=3000&pause=1000&center=true&vCenter=true&width=500&lines=%D0%A7%D0%B8%D1%81%D1%82%D0%B0%D1%8F+%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0;%D0%A0%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5+%D0%BD%D0%B0+%D1%81%D0%BB%D0%BE%D0%B8;%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9+%D0%B4%D0%B8%D0%B7%D0%B0%D0%B9%D0%BD" alt="Typing SVG" />
</p>

[![Architecture](https://img.shields.io/badge/Pattern-Clean%20Architecture-blue?style=for-the-badge)](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
[![Layers](https://img.shields.io/badge/Layers-6-green?style=for-the-badge)](#—Å–ª–æ–∏-–ø—Ä–æ–µ–∫—Ç–∞)
[![Mermaid](https://img.shields.io/badge/Diagrams-Mermaid-orange?style=for-the-badge)](#–æ–±—â–∞—è-—Å—Ö–µ–º–∞-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

</div>

## üìã –û –¥–æ–∫—É–º–µ–Ω—Ç–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É InvoiceFlowBot.

> [!NOTE]
> –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —á–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–ª–æ–∏

## üì¶ –°–ª–æ–∏ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤:

- **domain** - —á–∏—Å—Ç–∞—è –¥–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å—á–µ—Ç–æ–≤ –∏ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤.

- **services** - –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–≤—è–∑—ã–≤–∞–µ—Ç –¥–æ–º–µ–Ω, OCR –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

- **ocr** - –¥–≤–∏–∂–æ–∫ OCR –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (Mindee), –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

- **storage** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–ª–æ–π –ø–æ–≤–µ—Ä—Ö SQLite —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ Alembic.

- **handlers** - –≤—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π Telegram –Ω–∞ –±–∞–∑–µ aiogram 3.

- **core** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## –û–±—â–∞—è —Å—Ö–µ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```mermaid
flowchart LR
    TgUser[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram] -->|—Ñ–∞–π–ª—ã, –∫–æ–º–∞–Ω–¥—ã| Handlers

    subgraph Bot
        Handlers[handlers/*]
        Services[services/*]
        Domain[domain/*]
        OCR[ocr/*]
        Storage[storage/*]
        Config[config.py / core/*]
    end

    Handlers --> Services
    Services --> Domain
    Services --> OCR
    Services --> Storage
    OCR --> MindeeAPI[(Mindee API)]
    Storage --> SQLite[(SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)]
    Config --> Handlers
    Config --> Services
    Config --> Storage
```

## –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω–≤–æ–π—Å–∞

```mermaid
sequenceDiagram
    participant User as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant TG as Telegram Bot API
    participant H as handlers/file.py
    participant S as InvoiceService
    participant O as OcrProvider (Mindee)
    participant ST as AsyncInvoiceStorage

    User->>TG: –æ—Ç–ø—Ä–∞–≤–∫–∞ PDF –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    TG->>H: –∞–ø–¥–µ–π—Ç —Å —Ñ–∞–π–ª–æ–º
    H->>S: process_invoice_file(pdf_path, fast, max_pages)
    S->>O: extract(pdf_bytes)
    O->>MindeeAPI: HTTP –∑–∞–ø—Ä–æ—Å
    MindeeAPI-->>O: OCR JSON
    O-->>S: ExtractionResult
    S->>S: –º–∞–ø–ø–∏–Ω–≥ –≤ –¥–æ–º–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å Invoice
    S->>ST: save_invoice_domain_async(invoice)
    ST-->>S: id —Å—á–µ—Ç–∞
    S-->>H: Invoice —Å id
    H-->>User: —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —à–∞–ø–∫–æ–π –∏ –ø–æ–∑–∏—Ü–∏—è–º–∏
```
