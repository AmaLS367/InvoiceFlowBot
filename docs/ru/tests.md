<img src="https://capsule-render.vercel.app/api?type=waving&color=gradient&customColorList=12,16,20&height=120&section=header&text=–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ&fontSize=40&animation=fadeIn"/>

<div align="center">

[![pytest](https://img.shields.io/badge/Framework-pytest-blue?style=for-the-badge&logo=pytest)](https://pytest.org/)
[![Coverage](https://img.shields.io/badge/Coverage-80%25+-green?style=for-the-badge)](https://coverage.readthedocs.io/)
[![Tests](https://img.shields.io/badge/Tests-160+-orange?style=for-the-badge)](#–∑–∞–ø—É—Å–∫)

</div>

## üìã –û —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pytest. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `pyproject.toml` –≤ —Å–µ–∫—Ü–∏–∏ `[project.optional-dependencies]`.

> [!NOTE]
> –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -e .[dev]`

## üöÄ –ó–∞–ø—É—Å–∫

```powershell
git clone https://github.com/AmaLS367/InvoiceFlowBot.git
cd InvoiceFlowBot
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install -e .[dev]
pytest
```

–ö–æ–º–∞–Ω–¥–∞ `pytest` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç —Ç–µ—Å—Ç—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `tests/`.

## –ü–æ–∫—Ä—ã—Ç–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç **80% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞** —Å **160+ —Ç–µ—Å—Ç–∞–º–∏**, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–º–∏ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏:

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `test_invoice_parsing.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ Mindee –≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Ç–∏–ª–∏—Ç—ã
- `test_engine_utilities.py` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —É—Ç–∏–ª–∏—Ç OCR-–¥–≤–∏–∂–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `test_storage_dates.py` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞—Ç, ISO —Ñ–æ—Ä–º–∞—Ç—ã –∏ –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –ë–î
- `test_imports.py` ‚Äî –±—ã—Å—Ç—Ä—ã–π smoke-—Ç–µ—Å—Ç –∏–º–ø–æ—Ä—Ç–∞ –∫–ª—é—á–µ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
- `test_invoice_service.py` ‚Äî —Ç–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è —Å –∑–∞–º–æ–∫–∞–Ω–Ω—ã–º–∏ OCR –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:
  - `process_invoice_file` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ OCR –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ –¥–æ–º–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
  - `save_invoice` –∏ `list_invoices` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–ª–æ–π —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

### –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

- `tests/handlers/test_callbacks_edit.py` ‚Äî —Ç–µ—Å—Ç—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—á–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ callback-–∫–Ω–æ–ø–∫–∏
- `tests/handlers/test_callbacks_misc.py` ‚Äî —Ç–µ—Å—Ç—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö callback-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- `tests/handlers/test_commands_basic.py` ‚Äî —Ç–µ—Å—Ç—ã –±–∞–∑–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
- `tests/handlers/test_commands_drafts.py` ‚Äî —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç—ã —Å —á–µ—Ä–Ω–æ–≤–∏–∫–∞–º–∏
- `tests/handlers/test_commands_invoices_force_reply.py` ‚Äî —Ç–µ—Å—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Å—á–µ—Ç–∞–º
- `tests/handlers/test_file_upload_*.py` ‚Äî —Ç–µ—Å—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

### –¢–µ—Å—Ç—ã OCR

- `tests/ocr/test_extract.py` ‚Äî —Ç–µ—Å—Ç—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `tests/ocr/test_async_client.py` ‚Äî —Ç–µ—Å—Ç—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ OCR-–∫–ª–∏–µ–Ω—Ç–∞
- `tests/ocr/test_router.py` ‚Äî —Ç–µ—Å—Ç—ã —Ä–æ—É—Ç–µ—Ä–∞ OCR

### –¢–µ—Å—Ç—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

- `tests/storage/test_mappers.py` ‚Äî —Ç–µ—Å—Ç—ã –º–∞–ø–ø–∏–Ω–≥–∞ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–æ–º –∏ –ë–î
- `tests/storage/test_storage_invoices_crud.py` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- `tests/storage/test_storage_migrations.py` ‚Äî —Ç–µ—Å—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

### –¢–µ—Å—Ç—ã –¥–æ–º–µ–Ω–∞

- `tests/domain/test_invoice*.py` ‚Äî —Ç–µ—Å—Ç—ã –¥–æ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (Invoice, InvoiceHeader, InvoiceItem –∏ –¥—Ä.)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

- `integration/test_flow_ocr_draft_save.py` ‚Äî –ø–æ–ª–Ω—ã–π flow –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—á–µ—Ç–∞ –æ—Ç OCR –¥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞:

- **ruff** ‚Äî –±—ã—Å—Ç—Ä—ã–π –ª–∏–Ω—Ç–µ—Ä Python –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∏–ª—è –∫–æ–¥–∞ –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
- **mypy** ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–ª—è Python

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -e .[dev]

# –ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞
python -m ruff check .

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤
python -m mypy backend/

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
python -m pytest
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª —Å —Ç–µ—Å—Ç–∞–º–∏:

```powershell
python -m pytest tests/test_invoice_service.py
```

CI-–ø–∞–π–ø–ª–∞–π–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç `ruff`, `mypy` –∏ `pytest` –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –∏ pull request.

## –ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- –ù–æ–≤—ã–µ —Ñ–∏—á–∏ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—Ç—å —Ç–µ—Å—Ç–∞–º–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –º–µ–Ω—è—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –ª–æ–≥–∏–∫–∞ OCR.
- –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π Pull Request –ø—Ä–æ–≥–æ–Ω—è–π—Ç–µ `pytest` –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ CI.
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∫–µ–π—Å–æ–≤ Mindee –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ PDF (–æ–±–µ–∑–ª–∏—á–µ–Ω–Ω—ã–º–∏).
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `ruff` –∏ `mypy` –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π pull request.
