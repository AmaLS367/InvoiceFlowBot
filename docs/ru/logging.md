# Логирование

Модуль `ocr/engine/util.py` настраивает ротационные логеры при первом запросе к `get_logger`. По умолчанию файлы создаются в каталоге `logs/` в корне проекта или по пути, указанному в `LOG_DIR`.

## Файлы логов

- `ocr_engine.log` — общий поток сообщений приложения, включая шаги OCR и обработку файлов.
- `errors.log` — предупреждения и ошибки уровня `WARNING` и выше.
- `router.log` — подробный трейс логики маршрутизатора OCR (канал `ocr.router`).
- `extract.log` — ходы выполнения `ocr.extract`, удобно для отладки парсинга Mindee.

## Управление поведением

| Переменная | Что меняет |
| --- | --- |
| `LOG_LEVEL` | Основной уровень логирования (например `DEBUG` для диагностики) |
| `LOG_ROTATE_MB` | Максимальный размер отдельных файлов до ротации |
| `LOG_BACKUPS` | Сколько архивных файлов хранить |
| `LOG_CONSOLE` | Включить поток в stdout/stderr (удобно в Docker logs) |
| `LOG_DIR` | Переместить логи в отдельный каталог или внешний том |

Все обработчики используют `RotatingFileHandler`, поэтому при достижении лимита создаются резервные копии `*.log.1`, `*.log.2` и т.д.

## Рекомендации

- Включайте `LOG_LEVEL=DEBUG` только на тестовых средах — в продакшене это быстро раздувает файлы и может содержать чувствительные данные.
- При отладке контейнера используйте `docker logs -f <container>` вместе с `LOG_CONSOLE=1`, чтобы видеть потоковые сообщения в реальном времени.
- Следите, чтобы каталог для логов был доступен на запись. При ошибках прав бот не сможет стартовать.
